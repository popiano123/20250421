import{d as k,a1 as T,r as d,w as q,A as z,h as c,i as t,o as D,f as g,g as e,s as K,j as $,al as O,a6 as N,ar as H,as as J,l as I,B as R,y as S,e as h,n as _,q as G,ap as P,P as Q,at as W,M as E,z as x,au as X,av as Y}from"./index.9ba822ed.js";import{s as Z}from"./card.esm.26e16bcd.js";import{b as ee,d as te,c as w}from"./datatable.esm.b172a70c.js";import{s as ue}from"./textarea.esm.23fdbdfa.js";import"./radiobutton.esm.69c4f86a.js";import"./index.esm.caa83189.js";const ae={class:"flex align-items-center gap-3 mb-5"},le={class:"flex align-items-center gap-3 mb-5"},oe={class:"flex justify-content-end gap-2"},se=k({__name:"NoticeEditDialog",props:{type:{},title:{},content:{},id:{},modelValue:{type:Boolean}},emits:["update:modelValue","operation:done"],setup(i,{emit:y}){const u=i,r=y,l=T({get:()=>u.modelValue,set:v=>r("update:modelValue",v)}),o=d(""),p=d(""),f=I(),b=d(!1),A=()=>{b.value=!1,l.value=!1,o.value="",p.value=""},B=async()=>{if(N(o.value)||N(p.value)){f.warn("\u8BF7\u8F93\u5165\u5B8C\u6574\uFF01");return}if(u.type==="edit"&&u.id===void 0){l.value=!1,f.warn("\u7CFB\u7EDF\u9519\u8BEF\uFF01");return}b.value=!0,u.type==="edit"?H(o.value,p.value,u.id).then(()=>f.success("\u4FEE\u6539\u6210\u529F\uFF01")).finally(A):J(o.value,p.value).then(()=>f.success("\u6DFB\u52A0\u6210\u529F\uFF01")).finally(A)};return q(l,v=>{v?(o.value=u.title,p.value=u.content):r("operation:done")}),(v,a)=>(D(),z(t(O),{visible:l.value,"onUpdate:visible":a[3]||(a[3]=F=>l.value=F),modal:"",header:`${v.type==="new"?"\u65B0\u5EFA":"\u7F16\u8F91"}\u516C\u544A`,style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:c(()=>[g("div",ae,[a[4]||(a[4]=g("label",{for:"email",class:"font-semibold w-6rem"},"\u6807\u9898",-1)),e(t(K),{class:"flex-auto",autocomplete:"off",type:"text",modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=F=>o.value=F)},null,8,["modelValue"])]),g("div",le,[a[5]||(a[5]=g("label",{for:"email",class:"font-semibold w-6rem"},"\u516C\u544A\u5185\u5BB9",-1)),e(t(ue),{placeholder:"",modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=F=>p.value=F),autoResize:!0,rows:"3",cols:"55"},null,8,["modelValue"])]),g("div",oe,[e(t($),{type:"button",label:"\u53D6\u6D88",severity:"secondary",onClick:a[2]||(a[2]=F=>l.value=!1),loading:b.value},null,8,["loading"]),e(t($),{type:"button",label:"\u786E\u8BA4",onClick:B,loading:b.value},null,8,["loading"])])]),_:1},8,["visible","header"]))}});var ne={root:"p-inputgroup"},ie=R.extend({name:"inputgroup",classes:ne}),re={name:"BaseInputGroup",extends:S,style:ie,provide:function(){return{$parentInstance:this}}},j={name:"InputGroup",extends:re,inheritAttrs:!1};function de(i,y,u,r,l,o){return D(),h("div",G({class:i.cx("root")},i.ptmi("root")),[_(i.$slots,"default")],16)}j.render=de;var pe={root:"p-inputgroup-addon"},ce=R.extend({name:"inputgroupaddon",classes:pe}),ve={name:"BaseInputGroupAddon",extends:S,style:ce,provide:function(){return{$parentInstance:this}}},U={name:"InputGroupAddon",extends:ve,inheritAttrs:!1};function me(i,y,u,r,l,o){return D(),h("div",G({class:i.cx("root")},i.ptmi("root")),[_(i.$slots,"default")],16)}U.render=me;const fe={class:"col-12"},Fe={class:"md:flex md:flex-row md:flex-nowrap"},Ce=k({__name:"NoticeManager",setup(i){const y=d(!1),u=d([]),r=I(),l=d(!1),o=d(""),p=d(""),f=d(void 0),b=P(),A=d("edit"),B=d(void 0),v=d(!1),a=m=>{o.value=m.title,p.value=m.content,f.value=m.id,l.value=!0},F=(m,s)=>{b.require({target:m.target,message:"\u60A8\u8981\u5220\u9664\u6B64\u516C\u544A\u5417\uFF1F",icon:"pi pi-info-circle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:"\u53D6\u6D88",acceptLabel:"\u786E\u5B9A",accept:async()=>{try{r.default("\u6B63\u5728\u5220\u9664\u2026\u2026"),await X(s.id),r.success("\u5220\u9664\u6210\u529F");const n=u.value.findIndex(C=>C.id===s.id);u.value.splice(n,1)}catch{r.warn("\u5220\u9664\u5931\u8D25\uFF01")}},reject:()=>{}})},V=async()=>{try{y.value=!0;const m=await W();m.data.data.length>0&&(u.value.length=0,u.value.push(...m.data.data))}catch{r.warn("\u52A0\u8F7D\u516C\u544A\u5931\u8D25\uFF01\u8BF7\u7A0D\u540E\u5237\u65B0\u9875\u9762\uFF01")}finally{y.value=!1}},L=()=>{o.value="",p.value="",f.value=void 0,A.value="new",l.value=!0},M=async()=>{if(B.value==null){r.warn("\u8BF7\u9009\u62E9\u516C\u544A\uFF01");return}v.value=!0;try{await Y(B.value.id),r.success("\u8BBE\u7F6E\u6210\u529F\uFF01")}catch{B.value=void 0,r.warn("\u8BBE\u7F6E\u5931\u8D25\uFF01")}v.value=!1};return Q(V),(m,s)=>(D(),h("div",fe,[e(se,{"onOperation:done":V,title:o.value,content:p.value,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=n=>l.value=n),type:A.value,id:f.value},null,8,["title","content","modelValue","type","id"]),e(t(Z),null,{content:c(()=>[e(t(ee),{value:u.value,dataKey:"id",tableStyle:"min-width: 60rem",loading:y.value},{loading:c(()=>s[2]||(s[2]=[E(" \u6B63\u5728\u52A0\u8F7D\uFF0C\u8BF7\u7A0D\u540E\u2026\u2026 ")])),empty:c(()=>s[3]||(s[3]=[E(" \u6682\u65F6\u6CA1\u6709\u6570\u636E\uFF0C\u6DFB\u52A0\u4E00\u4E2A\u5427\uFF01 ")])),header:c(()=>[g("div",Fe,[e(t($),{icon:"pi pi-plus",label:"\u6DFB\u52A0\u516C\u544A",class:"mr-2 mb-2 flex-grow-0",onClick:L}),e(t(j),{class:"flex-grow-0"},{default:c(()=>[e(t(U),null,{default:c(()=>s[4]||(s[4]=[E("\u6FC0\u6D3B\u7684\u516C\u544A")])),_:1}),e(t(te),{options:u.value,optionLabel:"title",placeholder:"\u9009\u62E9\u516C\u544A",modelValue:B.value,"onUpdate:modelValue":s[1]||(s[1]=n=>B.value=n)},{option:c(n=>[g("span",null,x(n.option.id)+" - "+x(n.option.title),1)]),_:1},8,["options","modelValue"]),e(t($),{label:"\u786E\u5B9A",onClick:M,loading:v.value},null,8,["loading"])]),_:1})])]),default:c(()=>[e(t(w),{field:"id",header:"ID",sortable:!0}),e(t(w),{field:"title",header:"\u6807\u9898"}),e(t(w),{header:"\u5185\u5BB9"},{body:c(n=>[g("p",null,x(n.data.content.substring(0,100)),1)]),_:1}),e(t(w),{header:"\u64CD\u4F5C",headerStyle:"width:4rem"},{body:c(n=>[e(t($),{icon:"pi pi-eye",rounded:"",class:"mb-2 mr-2",onClick:C=>a(n.data)},null,8,["onClick"]),e(t($),{icon:"pi pi-trash",severity:"danger",rounded:"",class:"mb-2 mr-2",onClick:C=>F(C,n.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"])]),_:1})]))}});export{Ce as default};
