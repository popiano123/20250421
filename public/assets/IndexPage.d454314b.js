import{s as b}from"./panel.esm.7ca97350.js";import{s as y}from"./menu.esm.71e9723e.js";import{d as x,u as k,a as V,r,b as D,c as S,w as P,e as E,f as s,g as i,h as c,i as d,o as U,s as w,j as $,k as q,l as I}from"./index.9ba822ed.js";import{g as R}from"./parse.ccca86de.js";import{_ as L}from"./HistoryTotal.vue_vue_type_script_setup_true_lang.5c5bfaf4.js";import"./index.esm.ac3817b7.js";import"./index.esm.caa83189.js";function z(m){var p,f;const o={},a=/https?:\/\/(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\(),]|%[0-9a-fA-F][0-9a-fA-F])+/,l=/提取码([:：])\s*(([a-zA-Z]|[0-9]){4})/;if(!a.test(m))return o;let n=(p=a.exec(m))==null?void 0:p[0];if(n===void 0)return o;let t=new URL(n);return t.host!=="pan.baidu.com"||(o.pwd=t.searchParams.get("pwd")||((f=l.exec(m))==null?void 0:f[2])||"",o.surl=t.searchParams.has("surl")?`1${t.searchParams.get("surl")}`:t.pathname.substring(3)),o}const N={class:"main-container"},Z={class:"main"},j=["disabled"],M={class:"p-fluid"},O={class:"field",id:"driver-step-pan-url-input"},T={class:"field",id:"driver-step-pan-pwd-input"},Y=x({__name:"IndexPage",setup(m){const o=k(),a=V(),l=r(""),n=r(""),t=r(""),p=r(!1),f=r(!1),C=D(),F=I(),_=S(),g=r(),B=r([{label:"\u66F4\u591A\u64CD\u4F5C",items:[{label:"\u516C\u544A",icon:"pi pi-bell",command:()=>{a.noticeDialog=!a.noticeDialog}},{label:"\u767B\u5F55\u540E\u53F0",icon:"pi pi-cloud",command:()=>{a.adminLogin=!a.adminLogin}},{label:"\u65B0\u624B\u6559\u7A0B",icon:"pi pi-graduation-cap",command:()=>{window.localStorage.removeItem("driver-step-done"),q()}}]}]),h=u=>{var e;(e=g==null?void 0:g.value)==null||e.toggle(u)},A=async()=>{let u;_.requires_key!=="none"&&(a.parseVerify=!0,u=await a.awaitForParseVerify(),u.length===0)||(p.value=!0,F.default("\u6B63\u5728\u52A0\u8F7D\u2026\u2026"),R(t.value,l.value,u).then(({data:e})=>{C.req_id=e.data,o.push({name:"Parsed",params:{reqId:e.data,surl:t.value,pwd:l.value}})}))};return P(n,u=>{const e=z(u);e.pwd&&(l.value=e.pwd,F.success("\u8BC6\u522B\u5230\u5BC6\u7801\uFF0C\u5DF2\u81EA\u52A8\u586B\u5145\uFF01")),e.surl&&(t.value=e.surl)}),(u,e)=>(U(),E("div",N,[s("div",Z,[i(d(b),null,{header:c(()=>e[2]||(e[2]=[s("div",{class:"title"},[s("span",{class:"font-bold"},"F4Pan")],-1)])),icons:c(()=>[i(d(y),{ref_key:"menu",ref:g,id:"overlay_menu",model:B.value,popup:!0},null,8,["model"]),s("button",{class:"p-panel-header-icon p-link mr-2",onClick:h,disabled:p.value,id:"driver-step-menu"},e[3]||(e[3]=[s("span",{class:"pi pi-cog"},null,-1)]),8,j)]),default:c(()=>[s("div",M,[s("div",O,[e[4]||(e[4]=s("label",{for:"disk-url"},"\u7F51\u76D8\u94FE\u63A5",-1)),i(d(w),{type:"text",modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=v=>n.value=v)},null,8,["modelValue"])]),s("div",T,[e[5]||(e[5]=s("label",{for:"disk-password"},"\u7F51\u76D8\u5BC6\u7801",-1)),i(d(w),{type:"text",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=v=>l.value=v)},null,8,["modelValue"])]),i(d($),{onClick:A,label:"\u63D0\u4EA4",id:"driver-step-action-parse"})])]),_:1}),i(d(b),{class:"mt-4",toggleable:"",collapsed:!f.value},{header:c(()=>e[6]||(e[6]=[s("div",{class:"flex align-items-center gap-2"},[s("span",{class:"font-bold"},"\u5386\u53F2\u7EDF\u8BA1")],-1)])),default:c(()=>[i(L,{days:4})]),_:1},8,["collapsed"])])]))}});export{Y as default};
